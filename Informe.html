<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe General - UTE</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; background: white; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background-color: #7c3aed; color: white; }
        .section-title { margin-top: 2rem; color: #4c1d95; border-bottom: 2px solid #7c3aed; display: inline-block; }
    </style>
</head>
<body>
    <header>
        <h1 data-i18n="report_title">Informe General de Registros</h1>
        <nav>
            <ul>
                <li><a href="index.html" data-i18n="nav_home">Inicio</a></li>
                <li><a href="eventos.html" data-i18n="nav_events">Eventos</a></li>
                <li><a href="contactos.html" data-i18n="nav_contacts">Contactos</a></li>
                <li><a href="ubicacion.html" data-i18n="nav_locations">Ubicaciones</a></li>
            </ul>
        </nav>
        <div style="text-align:center; margin-top: 1rem;">
            <button class="lang-btn" onclick="setLanguage('esp')">üá™üá® Espa√±ol</button>
            <button class="lang-btn" onclick="setLanguage('eng')">üá∫üá∏ English</button>
        </div>
    </header>

    <main style="padding: 2rem;">
        <h2 class="section-title" data-i18n="nav_events">Eventos</h2>
        <table>
            <thead>
                <tr>
                    <th data-i18n="lbl_title">T√çTULO</th>
                    <th data-i18n="lbl_date">FECHA Y HORA</th>
                    <th data-i18n="lbl_place">LUGAR</th>
                </tr>
            </thead>
            <tbody id="tabla-eventos"></tbody>
        </table>

        <h2 class="section-title" data-i18n="nav_contacts">Contactos</h2>
        <table>
            <thead>
                <tr>
                    <th data-i18n="lbl_full_name">NOMBRES</th>
                    <th data-i18n="lbl_job">PROFESI√ìN</th>
                    <th data-i18n="lbl_email">CORREO</th>
                </tr>
            </thead>
            <tbody id="tabla-contactos"></tbody>
        </table>

        <h2 class="section-title" data-i18n="nav_locations">Ubicaciones</h2>
        <table>
            <thead>
                <tr>
                    <th data-i18n="lbl_title">T√çTULO</th>
                    <th data-i18n="lbl_address">DIRECCI√ìN</th>
                </tr>
            </thead>
            <tbody id="tabla-ubicaciones"></tbody>
        </table>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDxKQWalmHfLxhbYGru_hzvfuVCUJuHuzw",
            authDomain: "caso-practico-c631b.firebaseapp.com",
            projectId: "caso-practico-c631b",
            storageBucket: "caso-practico-c631b.firebasestorage.app",
            messagingSenderId: "233285378258",
            appId: "1:233285378258:web:8abcd2c3ae504e17da8d0b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function cargarDatos() {
            // Cargar Eventos
            const qEv = query(collection(db, "eventos"), orderBy("createdAt", "desc"));
            const snapEv = await getDocs(qEv);
            snapEv.forEach(doc => {
                const d = doc.data();
                document.getElementById('tabla-eventos').innerHTML += `<tr><td>${d.titulo}</td><td>${d.fecha_hora}</td><td>${d.lugar}</td></tr>`;
            });

            // Cargar Contactos
            const qCon = query(collection(db, "contactos"), orderBy("createdAt", "desc"));
            const snapCon = await getDocs(qCon);
            snapCon.forEach(doc => {
                const d = doc.data();
                document.getElementById('tabla-contactos').innerHTML += `<tr><td>${d.nombre}</td><td>${d.profesion}</td><td>${d.email}</td></tr>`;
            });

            // Cargar Ubicaciones
            const qUb = query(collection(db, "ubicaciones"), orderBy("createdAt", "desc"));
            const snapUb = await getDocs(qUb);
            snapUb.forEach(doc => {
                const d = doc.data();
                document.getElementById('tabla-ubicaciones').innerHTML += `<tr><td>${d.nombre}</td><td>${d.direccion}</td></tr>`;
            });
        }

        cargarDatos();
    </script>

    <script>
        const I18N = {
            esp: {
                nav_home: "Inicio", nav_events: "Eventos", nav_contacts: "Contactos", nav_locations: "Ubicaciones",
                report_title: "Informe General de Registros",
                lbl_title: "T√çTULO", lbl_date: "FECHA Y HORA", lbl_place: "LUGAR",
                lbl_full_name: "NOMBRES", lbl_job: "PROFESI√ìN", lbl_email: "CORREO", lbl_address: "DIRECCI√ìN"
            },
            eng: {
                nav_home: "Home", nav_events: "Events", nav_contacts: "Contacts", nav_locations: "Locations",
                report_title: "General Records Report",
                lbl_title: "TITLE", lbl_date: "DATE & TIME", lbl_place: "LOCATION",
                lbl_full_name: "NAMES", lbl_job: "PROFESSION", lbl_email: "EMAIL", lbl_address: "ADDRESS"
            }
        };

        function setLanguage(lang) {
            localStorage.setItem('lang', lang);
            document.documentElement.lang = (lang === 'esp') ? 'es' : 'en';
            const texts = I18N[lang];
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (texts[key]) el.textContent = texts[key];
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const savedLang = localStorage.getItem('lang') || 'esp';
            setLanguage(savedLang);
        });
    </script>
</body>
</html>